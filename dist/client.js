import{apiTokens}from"./resources/apiTokens";import{alerts}from"./resources/alerts";import{applications}from"./resources/applications";import{servers}from"./resources/servers";import{user}from"./resources/user";import{workspaces}from"./resources/workspaces";import{integrations}from"./resources/integrations";import{providers}from"./resources/providers";import{deployments}from"./resources/deployments";import{notifications}from"./resources/notifications";import{projects}from"./resources/projects";import{templates}from"./resources/templates";import{github}from"./resources/github";export class ApiError extends Error{constructor(t,s,r){super(`HTTP ${t}: ${s}${r?` - ${r}`:""}`),this.status=t,this.statusText=s,this.body=r,this.name="ApiError"}}export class Serversinc{constructor(t,s,r={}){this.apiTokens=apiTokens(this),this.alerts=alerts(this),this.applications=applications(this),this.servers=servers(this),this.user=user(this),this.workspaces=workspaces(this),this.integrations=integrations(this),this.providers=providers(this),this.deployments=deployments(this),this.notifications=notifications(this),this.projects=projects(this),this.templates=templates(this),this.github=github(this),this.baseURL=t.replace(/\/$/,""),this.token=s,this.timeout=r.timeout??3e4,this.retries=r.retries??3}setToken(t){this.token=t}async request(t,s,r,e,i=!0){const o=`${this.baseURL}${s}`;for(let s=0;s<=this.retries;s++)try{const s=new AbortController,n=setTimeout(()=>s.abort(),this.timeout),a={...e};i&&(a.Authorization=`Bearer ${this.token}`),r&&!a["Content-Type"]&&(a["Content-Type"]="application/json");const p=await fetch(o,{method:t,headers:a,body:r?JSON.stringify(r):void 0,signal:s.signal});if(clearTimeout(n),!p.ok){const t=await p.text();throw new ApiError(p.status,p.statusText,t)}if(204===p.status)return;return p.json()}catch(t){if(t instanceof ApiError)throw t;if(s===this.retries)throw t;await new Promise(t=>setTimeout(t,1e3*Math.pow(2,s)))}throw new Error("Unexpected error in request loop")}}Serversinc.VERSION="1.0.0";